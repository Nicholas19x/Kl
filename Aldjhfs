-- โหลด OrionLib จาก URL ที่ระบุ
local OrionLib = loadstring(game:HttpGet(('https://raw.githubusercontent.com/shlexware/Orion/main/source')))()

-- สร้างหน้าต่างของ OrionLib
local Window = OrionLib:MakeWindow({Name = "Title of the library", HidePremium = false, SaveConfig = true, ConfigFolder = "OrionTest"})

-- สร้างแท็บสำหรับการตั้งค่า
local AutofarmSettingTab = Window:MakeTab({
	Name = "Setting",
	Icon = "rbxassetid://4483345998",
	PremiumOnly = false
})

-- สร้างแท็บสำหรับการฟาร์มอัตโนมัติ
local AutofarmTab = Window:MakeTab({
	Name = "Auto farm",
	Icon = "rbxassetid://4483345998",
	PremiumOnly = false
})

-- แก้ไขเป็นตัวพิมพ์เล็กสำหรับ 'game'
local melee = game:GetService("Players").LocalPlayer.PlayerStats.FightingStyle
local sword = game:GetService("Players").LocalPlayer.PlayerStats.SwordName

-- เพิ่ม Dropdown ในแท็บการตั้งค่า
AutofarmSettingTab:AddDropdown({
	Name = "Weapon",
	Default = "melee",
	Options = {"melee", "sword"},
	Callback = function(Value)
		-- ตรวจสอบว่าผู้เล่นเลือก "melee" หรือ "sword" และแสดงค่าที่เกี่ยวข้อง
		if Value == "melee" and melee then
			print(melee.Value)
		elseif Value == "sword" and sword then
			print(sword.Value)
		else
			warn("Invalid selection or stat not found")
		end
	end    
})

-- ฟังก์ชันตรวจสอบเลเวล
function checklevel()
    local lv = game:GetService("Players").LocalPlayer.PlayerStats.lvl.Value
    if lv == 1 or lv >= 9999 then  -- แก้ไขเปรียบเทียบการเช็คเลเวล
        Mon = "Soldier [Lv. 1]"  -- แก้ไขชื่อ Monster
        Quest = "Kill 4 Soldiers"  -- แก้ไขชื่อ Quest
    end
end

-- สร้างกระบวนการใหม่ (Thread) เพื่อทำงานแยกจากโค้ดหลัก
spawn(function()
    while task.wait(.1) do
        pcall(function()
            -- ตรวจสอบว่า Auto_Farm ถูกเปิดใช้งานหรือไม่ (_G.Auto_Farm)
            if _G.Auto_Farm then
                checklevel()  -- เรียกใช้ฟังก์ชัน checklevel
                
                -- ตรวจสอบว่า QuestBoard ไม่แสดงอยู่หรือไม่
                if game:GetService("Players").LocalPlayer.PlayerGui.MainGui.QuestBoard.Visible == false then
                    local args = {
                        [1] = "take",
                        [2] = "Quest"
                    }

                    -- เรียกใช้ RemoteFunction เพื่อขอรับเควส
                    game:GetService("ReplicatedStorage").Chest.Remotes.Functions.Quest:InvokeServer(unpack(args))
                end
            end
        end)
    end
end)

-- ตรวจสอบเมื่อ QuestBoard เปิดอยู่
spawn(function()
    while _G.Auto_Farm do
        if game:GetService("Players").LocalPlayer.PlayerGui.MainGui.QuestBoard.Visible == true then
            for _,v in pairs(game:GetService("Workspace").Monster.Mon:GetChildren()) do
                if v.Name == Mon then
                    totarget(v.HumanoidRootPart.CFrame * CFrame.new(0,1,15))
                    v.HumanoidRootPart.Size = Vector3.new(60,2.5,60)
                    v.HumanoidRootPart.CFrame = CFrameMon
                end
            end
        end
        task.wait(0.1)
    end
end)

-- เพิ่ม Toggle ในแท็บ Auto farm
AutofarmTab:AddToggle({
	Name = "Auto farm",
	Default = false,
	Callback = function(Value)
		_G.Auto_Farm = Value
		if _G.Auto_Farm then
			print("Auto farm started")
		else
			print("Auto farm stopped")
		end
	end    
})
